# aggregation
#     SELECT    :    $project / $group($addToSet, $first, $last, $max, $min, $avg, $push, $sum)
#     FROM      :    db.mongodb_collection.aggregate(...)
#     JOIN      :    $unwind
#     WHERE     :    $match
#     ORDER BY  :    $sort
#     GROUP BY  :    $group
#     HAVING    :    $match
#     LIMIT     :    $limit
#     export    :    $out
#     flatten   :    $unwind
#     skip      :    $skip
#     string    :    $concat / $strcasecmp / $substr / $toLower / $toUpper
#     arithmetic:    $add / $divide / $mod / $multiply / $subtract
#     date      :    $dayOfYear / $dayOfMonth / $dayOfWeek / $year / $month / $week / $hour / $minute / $second / $millisecond
#     logical   :    $and / $cmp / $cond / $eq / $gt / $gte / $ifNull / $lt / $lte / $ne / $not / $or
#     set       :    $setEquals / $setIntersection / $setDifference / $setUnion / $setIsSubset / $anyElementTrue / $allElementsTrue 
#     other     :    $meta / $size / $map / $let / $literal 
#     geo       :    $geoNear
#     ???       :    $redact

# Stage Operators
#     $project     :    SELECT
#     $match       :    WHERE
#     $redact ($$DESCEND / $$PRUNE / $$KEEP)
#     $limit       :    LIMIT
#     $skip        :    SKIP
#     $unwind      :    JOIN
#     $group       :    GROUP BY
#     $sort        :    ORDER BY
#     $geoNear
#     $out         :    EXPORT
db.mongodb_collection.aggregate([
    {
        "$project" : {
            "string" : 1,
            "int" : 1
        }
    },    
])
db.mongodb_collection.aggregate([
    {
        "$match" : { 
            "int" : { "$gt" : 0 } 
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        $redact: {
			$cond: {
				if: {
					"$or" : [
						{ "$eq" : [ "$string", "string_0" ] },
						{ "$eq" : [ "$key_0", "value_0_0_0" ] }
					]	
				},
				then: "$$DESCEND",
				else: "$$PRUNE"
			}
        }
    }
]).pretty()
   
db.mongodb_collection.aggregate([
    {
        "$group" : { "_id" : "$null" }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"strings" : { "$addToSet" : "$string" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"firstString" : { "$first" : "$string" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"lastString" : { "$last" : "$string" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"maxDouble" : { "$max" : "$double" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"minDouble" : { "$min" : "$double" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"avgDouble" : { "$avg" : "$double" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"pushString" : { "$push" : "$string" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$group" : {
        	"_id" : "$null",
        	"addToSetString" : { "$addToSet" : "$string" }
        }
    }
]).pretty()

db.mongodb_collection.aggregate([
    {
        "$sort" : { 
            "int" : -1 
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$skip" : 1
    }
]).pretty() 
db.mongodb_collection.aggregate([
    {
        "$limit" : 1
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$unwind" : "$array"
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$out" : "mongodb_out"
    },    
])

db.mongodb_collection.aggregate([
    {
        "$project" : {
            "concatString" : { "$concat" : [ "--", "$string" , "--" ] },
            "strcasecmpString" : { "$strcasecmp" : [ "$string" , "STRING_0" ] },
            "substrString" : { "$substr" : [ "$string" , 2, 1 ] },
            "toLowerString" : { "$toLower" : "$string" },
            "toUpperString" : { "$toUpper" : "$string" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$project" : {
            "addDouble" : { "$add" : [ "$double", 3 ] },
            "divideDouble" : { "$divide" : [ "$double", 3 ] },
            "modDouble" : { "$mod" : [ "$double", 3 ] },
            "multiplyDouble" : { "$multiply" : [ "$double", 3 ] },
            "subtractDouble" : { "$subtract" : [ "$double", 3 ] }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$project" : {
            "dayOfYear" : { "$dayOfYear" : "$date" },
            "dayOfMonth" : { "$dayOfMonth" : "$date" },
            "dayOfWeek" : { "$dayOfWeek" : "$date" },
            "year" : { "$year" : "$date" },
            "month" : { "$month" : "$date" },
            "week" : { "$week" : "$date" },
            "hour" : { "$hour" : "$date" },
            "minute" : { "$minute" : "$date" },
            "second" : { "$second" : "$date" },
            "millisecond" : { "$millisecond" : "$date" }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$project" : {
            "and" : { "$and" : [ true, true, true ] },
            "cmp" : { "$cmp" : [ "$double", 1.1 ] },
            "cond" : { 
				$cond : { 
					if: true, 
					then: "Y" ,
					else: "N"
				}
            },
            "eq" : { "$eq" : [ "$double", 1.1 ] },
            "gt" : { "$gt" : [ "$double", 1 ] },
            "gte" : { "$gte" : [ "$double", 1 ] },
            "ifNull" : { "$ifNull" : [ "$null", "if null" ] },
            "lt" : { "$lt" : [ "$double", 1 ] },
            "lte" : { "$lte" : [ "$double", 1 ] },
            "ne" : { "$ne" : [ "$double", 1.1 ] },
            "not" : { "$not" : true },
            "or" : { "$or" : [ false, false, true ] }
        }
    }
]).pretty()
db.mongodb_collection.aggregate([
    {
        "$project" : {
            "setEquals" : { "$setEquals" : [ "$array", ["繁體中文字串測試_0","其他不相關字串_0","text_0"] ] },
            "setIntersection" : { "$setIntersection" : [ "$array", ["繁體中文字串測試_0","其他不相關字串_0","text_0"] ] },
            "setDifference" : { "$setDifference" : [ "$array", ["繁體中文字串測試_0","其他不相關字串_0","text_0"] ] },
            "setUnion" : { "$setUnion" : [ "$array", ["繁體中文字串測試_0","其他不相關字串_0","text_0"] ] },
            "setIsSubset" : { "$setIsSubset" : [ "$array", ["繁體中文字串測試_0","其他不相關字串_0","text_0","other_0"] ] },
            "anyElementTrue" : { "$anyElementTrue" : [ [ false, false, true ] ] },
            "allElementsTrue" : { "$allElementsTrue" : [ [ true, true, true ] ] }
        }
    }
]).pretty()

$meta / $size / $map / $let / $literal 

